<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EV Log</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#4CAF50" />
  <meta name="apple-mobile-web-app-capable" content="yes">
</head>
<body>

  <header>
    <h1>EV Log</h1>
    <h2>charging + maintenance</h2>
  </header>

  <nav>
    <button class="tabbtn active" data-tab="log">Log</button>
    <button class="tabbtn" data-tab="costs">Costs</button>
    <button class="tabbtn" data-tab="compare">Compare</button>
    <button class="tabbtn" data-tab="settings">Settings</button>
  </nav>

  <section id="log" class="tab active">
    
    <div class="section-block">
      <label>–î–∞—Ç–∞</label>
      <input type="date" id="date" />
    </div>

    <div class="section-block">
      <label>kWh (–ó–∞—Ä–µ–¥–µ–Ω–æ)</label>
      <input type="number" id="kwh" placeholder="40" step="0.1" inputmode="decimal" />
    </div>

    <div id="log-preview" style="display:none; margin-bottom:15px;"></div>

    <div class="section-block">
      <label>–¢–∏–ø</label>
      <select id="type">
        <option value="public" data-price="0.56">üîå –ü—É–±–ª–∏—á–Ω–æ (0.56)</option>
        <option value="public-xp" data-price="0.79">‚ö° –ü—É–±–ª–∏—á–Ω–æ –°–∫—ä–ø–æ (0.79)</option>
        <option value="home" data-price="0.24">üè† –î–æ–º–∞—à–Ω–æ (0.24)</option>
        <option value="home-night" data-price="0.07">üåô –î–æ–º–∞—à–Ω–æ –ù–æ—â (0.07)</option>
        <option value="free" data-price="0.00">üÜì –ë–µ–∑–ø–ª–∞—Ç–Ω–æ</option>
      </select>
    </div>

    <div class="section-block">
      <label>–¶–µ–Ω–∞ (¬£/kWh)</label>
      <input type="number" id="price" placeholder="0.56" step="0.01" inputmode="decimal" />
    </div>

    <div class="section-block">
      <label>–ë–µ–ª–µ–∂–∫–∞</label>
      <input type="text" id="note" placeholder="Location / Note..." />
    </div>

    <div style="display:flex; gap:10px;">
        <button id="addEntry">Add Entry</button>
        <button id="sameAsLast" style="background:#222;">Same as last</button>
    </div>

    <details id="logDetails" open style="margin-top:20px;">
      <summary>–ò—Å—Ç–æ—Ä–∏—è –Ω–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ</summary>
      <div id="logTable" style="margin-top:10px;"></div>
    </details>
  </section>

  <section id="costs" class="tab">
    <h3>–î–æ–±–∞–≤–∏ —Ä–∞–∑—Ö–æ–¥</h3>
    
    <div class="section-block">
      <label>–û—Ç–Ω–∞—Å—è —Å–µ –∑–∞:</label>
      <select id="c_target" style="border: 1px solid #555; background:#222;">
        <option value="ev">üöó –ú–æ—è—Ç–∞ –ö–æ–ª–∞ (EV)</option>
        <option value="ice">‚õΩ –î–í–ì –ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞</option>
      </select>
      <small style="color:#666; display:block; margin-top:5px;">–ò–∑–±–µ—Ä–∏ "–î–í–ì" –∑–∞ —Ä–µ–∞–ª–Ω–∏ —Ä–∞–∑—Ö–æ–¥–∏ –ø–æ –≤—Ç–æ—Ä–∞—Ç–∞ –∫–æ–ª–∞.</small>
    </div>

    <div class="section-block">
      <label>–î–∞—Ç–∞</label>
      <input type="date" id="c_date" />
    </div>

    <div class="section-block">
      <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
      <select id="c_category">
        <option value="Tyres">Tyres (–ì—É–º–∏)</option>
        <option value="Service">Service (–û–±—Å–ª—É–∂–≤–∞–Ω–µ)</option>
        <option value="Insurance">Insurance (–ó–∞—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞)</option>
        <option value="Tax">Tax/MOT</option>
        <option value="Accessories">Accessories</option>
        <option value="Other">Other</option>
      </select>
    </div>

    <div class="section-block">
      <label>–°—É–º–∞ (¬£)</label>
      <input type="number" id="c_amount" placeholder="0.00" step="0.01" inputmode="decimal" />
    </div>

    <div class="section-block">
      <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
      <input type="text" id="c_note" placeholder="Detail..." />
    </div>

    <button id="c_add">Add Cost</button>
    <div id="costTable" style="margin-top:20px;"></div>
  </section>

  <section id="compare" class="tab">
    
    <div id="tco-dashboard" style="display:block; margin-bottom:25px;">
        <h3 style="margin-top:0;">üìä –ü—ä–ª–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        
        <div id="tco-card" style="padding:15px; border-radius:10px; text-align:center; margin-bottom:15px; background:#222;"></div>

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:20px;">
            <div style="background:#1a1a1a; padding:10px; border-radius:8px; border-left:2px solid #4CAF50;">
                <div style="font-size:0.8rem; color:#888;">‚ö° EV –ó–∞—Ä–µ–∂–¥–∞–Ω–µ</div>
                <div id="stat-ev-charge" style="font-size:1.1rem; font-weight:bold;">¬£0.00</div>
            </div>
            <div style="background:#1a1a1a; padding:10px; border-radius:8px; border-left:2px solid #4CAF50;">
                <div style="font-size:0.8rem; color:#888;">üöó EV –ü–æ–¥–¥—Ä—ä–∂–∫–∞</div>
                <div id="stat-ev-maint" style="font-size:1.1rem; font-weight:bold;">¬£0.00</div>
            </div>
            <div style="background:#1a1a1a; padding:10px; border-radius:8px; border-left:2px solid #f44336;">
                <div style="font-size:0.8rem; color:#888;">‚õΩ –î–í–ì –ì–æ—Ä–∏–≤–æ (est)</div>
                <div id="stat-ice-fuel" style="font-size:1.1rem; font-weight:bold;">¬£0.00</div>
            </div>
             <div style="background:#1a1a1a; padding:10px; border-radius:8px; border-left:2px solid #f44336;">
                <div style="font-size:0.8rem; color:#888;">üîß –î–í–ì –ü–æ–¥–¥—Ä—ä–∂–∫–∞</div>
                <div id="stat-ice-maint" style="font-size:1.1rem; font-weight:bold;">¬£0.00</div>
            </div>
        </div>

        <div style="text-align:center; margin-bottom:20px; font-size:0.9rem; color:#888;">
            –û–±—â –ø—Ä–æ–±–µ–≥: <span id="stat-miles" style="color:#fff; font-weight:bold;">0</span> mi
        </div>

        <div style="background:#1a1a1a; padding:15px; border-radius:10px; margin-bottom:20px;">
            <h4 style="margin:0 0 15px 0; color:#ccc; font-size:1rem;">üìà –ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∏ —Ä–∞–∑—Ö–æ–¥–∏</h4>
            <div style="position: relative; height:250px; width:100%">
                <canvas id="tcoChart"></canvas>
            </div>
        </div>

        <div style="background:#1a1a1a; padding:15px; border-radius:10px;">
            <h4 style="margin:0 0 10px 0; color:#ccc; font-size:1rem;">üìÖ –ú–µ—Å–µ—á–Ω–∞ —Ä–∞–∑–±–∏–≤–∫–∞</h4>
            <div id="monthly-stats-table"></div>
        </div>
    </div>

    <hr style="border:0; border-top:1px solid #333; margin: 20px 0;">

    <h3>üßÆ –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä –∑–∞ –ø—ä—Ç—É–≤–∞–Ω–µ</h3>
    <div class="compare-box" style="background:#111; padding:15px; border-radius:10px; border:1px solid #333; text-align:center;">
        <label>–†–∞–∑—Å—Ç–æ—è–Ω–∏–µ (–º–∏–ª–∏)</label>
        <input type="number" id="cmp-dist" placeholder="100" style="text-align:center; font-size:1.2rem; margin-bottom:10px;">
        <button id="btn-calc-trip">–ò–∑—á–∏—Å–ª–∏</button>
    </div>
    <div id="compare-result"></div>
  </section>

  <section id="settings" class="tab">
    <div style="background:#111; padding:15px; border-radius:10px; border:1px solid #333; margin-bottom:20px;">
        <h3 style="margin-top:0;">üèéÔ∏è EV vs ICE –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <div class="section-block"><label>EV –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç (mi/kWh)</label><input type="number" id="set_ev_eff" placeholder="3.0" step="0.1"></div>
        <div class="section-block"><label>ICE –†–∞–∑—Ö–æ–¥ (MPG)</label><input type="number" id="set_ice_mpg" placeholder="44" step="1"></div>
        <div class="section-block"><label>–¶–µ–Ω–∞ –ì–æ—Ä–∏–≤–æ (¬£/Liter)</label><input type="number" id="set_fuel_price" placeholder="1.45" step="0.01"></div>
        <button id="saveCompareSettings">Save Settings</button>
    </div>

    <div style="background:#111; padding:15px; border-radius:10px; border:1px solid #333;">
        <h3 style="margin-top:0;">üíæ Backup Data</h3>
        <button id="exportBackup" style="background:#333;">‚¨áÔ∏è Export JSON</button>
        <div style="margin-top:15px;"><label>Import JSON</label><input type="file" id="importBackup" /></div>
    </div>
  </section>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="app.js"></script> <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('SW registered'))
          .catch(err => console.log('SW failed', err));
      });
    }
  </script>
</body>
</html>

