<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EV Log</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#4CAF50" />
</head>
<body>

  <header>
    <h1>EV Log</h1>
    <h2>charging + maintenance</h2>
  </header>

  <nav>
    <button class="tabbtn active" data-tab="log">Log</button>
    <button class="tabbtn" data-tab="costs">Costs</button>
    <button class="tabbtn" data-tab="garage">Garage</button>
    <button class="tabbtn" data-tab="compare">Compare</button>
    <button class="tabbtn" data-tab="settings">Settings</button>
  </nav>

  <section id="log" class="tab active">
    <div class="section-block">
      <label>–î–∞—Ç–∞</label>
      <input type="date" id="date" />
    </div>

    <div class="section-block">
      <label>kWh</label>
      <input type="number" id="kwh" placeholder="40" step="0.1" inputmode="decimal" />
    </div>

    <div id="log-preview" style="display:none; margin-bottom:15px;"></div>

    <div class="section-block">
      <label>–¢–∏–ø</label>
      <select id="type">
        <option value="public" data-price="0.56">üîå –ü—É–±–ª–∏—á–Ω–æ (0.56)</option>
        <option value="public-xp" data-price="0.79">‚ö° –ü—É–±–ª–∏—á–Ω–æ –°–∫—ä–ø–æ (0.79)</option>
        <option value="home" data-price="0.24">üè† –î–æ–º–∞—à–Ω–æ (0.24)</option>
        <option value="home-night" data-price="0.07">üåô –î–æ–º–∞—à–Ω–æ –ù–æ—â (0.07)</option>
        <option value="free" data-price="0.00">üÜì –ë–µ–∑–ø–ª–∞—Ç–Ω–æ</option>
        <option value="manual">‚úèÔ∏è –†—ä—á–Ω–æ / –î—Ä—É–≥–æ</option>
      </select>
    </div>

    <div class="section-block">
      <label>–¶–µ–Ω–∞ (¬£/kWh)</label>
      <input type="number" id="price" placeholder="0.56" step="0.01" inputmode="decimal" />
    </div>

    <div class="section-block">
      <label>–ë–µ–ª–µ–∂–∫–∞</label>
      <input type="text" id="note" placeholder="Location..." />
    </div>

    <button id="addEntry">Add Entry</button>

    <details id="logDetails" open style="margin-top:20px;">
      <summary>–ò—Å—Ç–æ—Ä–∏—è</summary>
      <div id="logTable" style="margin-top:10px;"></div>
    </details>
  </section>

  <section id="costs" class="tab">
    <div class="section-block">
      <label>–†–∞–∑—Ö–æ–¥ –∑–∞:</label>
      <select id="c_target" style="border:1px solid #555; background:#222;">
        <option value="ev">üöó –ú–æ—è—Ç–∞ –ö–æ–ª–∞ (EV)</option>
        <option value="ice">‚õΩ –î–í–ì (–í—Ç–æ—Ä–∞ –∫–æ–ª–∞)</option>
      </select>
    </div>
    <div class="section-block"><label>–î–∞—Ç–∞</label><input type="date" id="c_date" /></div>
    <div class="section-block">
      <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
      <select id="c_category">
        <option value="Tyres">–ì—É–º–∏</option>
        <option value="Service">–°–µ—Ä–≤–∏–∑</option>
        <option value="Insurance">–ó–∞—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</option>
        <option value="Tax">–î–∞–Ω—ä–∫/MOT</option>
        <option value="Other">–î—Ä—É–≥–æ</option>
      </select>
    </div>
    <div class="section-block"><label>–°—É–º–∞ (¬£)</label><input type="number" id="c_amount" placeholder="0.00" inputmode="decimal"/></div>
    <div class="section-block"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><input type="text" id="c_note" /></div>
    <button id="c_add">Add Cost</button>
    <div id="costTable" style="margin-top:20px;"></div>
  </section>

  <section id="garage" class="tab">
    
    <div style="background:#1a1a1a; padding:15px; border-radius:10px; margin-bottom:20px; border:1px solid #333;">
        <h3 style="margin-top:0; color:#ccc;">üîî –ù–∞–ø–æ–º–Ω—è–Ω–∏—è</h3>
        
        <div class="reminder-row">
            <label>Insurance (–ó–∞—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞)</label>
            <input type="date" id="g_insurance" class="garage-date">
            <div id="status_insurance" class="status-badge">--</div>
        </div>

        <div class="reminder-row">
            <label>MOT / Tax (–ü—Ä–µ–≥–ª–µ–¥)</label>
            <input type="date" id="g_mot" class="garage-date">
            <div id="status_mot" class="status-badge">--</div>
        </div>

        <div class="reminder-row">
            <label>Service (–û–±—Å–ª—É–∂–≤–∞–Ω–µ)</label>
            <input type="date" id="g_service" class="garage-date">
            <div id="status_service" class="status-badge">--</div>
        </div>
    </div>

    <div style="background:#1a1a1a; padding:15px; border-radius:10px; border:1px solid #333;">
        <h3 style="margin-top:0; color:#ccc;">üìÑ –î–∞–Ω–Ω–∏ –∑–∞ –∫–æ–ª–∞—Ç–∞</h3>
        
        <div class="section-block">
            <label>Registration Plate</label>
            <input type="text" id="g_plate" placeholder="XX00 XXX">
        </div>
        
        <div class="section-block">
            <label>VIN Number</label>
            <input type="text" id="g_vin" placeholder="..." style="font-family:monospace; letter-spacing:1px;">
        </div>

        <div class="section-block">
            <label>Tyre Size (Front)</label>
            <input type="text" id="g_tyre_f" placeholder="e.g. 235/45 R18">
        </div>

        <div class="section-block">
            <label>Tyre Size (Rear)</label>
            <input type="text" id="g_tyre_r" placeholder="e.g. 255/40 R18">
        </div>
        
        <div class="section-block">
            <label>Notes (Oil type, Paint code...)</label>
            <textarea id="g_notes" rows="3" style="width:100%; background:#222; color:#fff; border:1px solid #444; border-radius:8px; padding:10px;"></textarea>
        </div>
    </div>
    
    <p style="text-align:center; color:#666; font-size:0.8rem; margin-top:10px;">–î–∞–Ω–Ω–∏—Ç–µ —Å–µ –∑–∞–ø–∞–∑–≤–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>
  </section>

  <section id="compare" class="tab">
    <div id="tco-dashboard" style="display:none; margin-bottom:20px;">
        <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        <div id="tco-card" style="padding:15px; border-radius:10px; text-align:center; background:#222; margin-bottom:15px;"></div>
        
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:20px;">
            <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #4CAF50">
                <small style="color:#888">EV –¢–æ–∫</small><div id="stat-ev-charge" style="font-weight:bold">¬£0</div>
            </div>
            <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #4CAF50">
                <small style="color:#888">EV –ü–æ–¥–¥—Ä—ä–∂–∫–∞</small><div id="stat-ev-maint" style="font-weight:bold">¬£0</div>
            </div>
            <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #f44336">
                <small style="color:#888">ICE –ì–æ—Ä–∏–≤–æ</small><div id="stat-ice-fuel" style="font-weight:bold">¬£0</div>
            </div>
            <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #f44336">
                <small style="color:#888">ICE –ü–æ–¥–¥—Ä—ä–∂–∫–∞</small><div id="stat-ice-maint" style="font-weight:bold">¬£0</div>
            </div>
        </div>
        <div style="text-align:center; margin-bottom:10px;">–ü—Ä–æ–±–µ–≥: <span id="stat-miles">0</span> mi</div>
        
        <div style="background:#1a1a1a; padding:10px; border-radius:10px; height:250px;">
            <canvas id="tcoChart"></canvas>
        </div>
    </div>
    
    <h3>üßÆ –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä (Trip)</h3>
    <div class="compare-box" style="background:#111; padding:15px; border-radius:10px; text-align:center;">
        <label>–†–∞–∑—Å—Ç–æ—è–Ω–∏–µ (–º–∏–ª–∏)</label>
        <input type="number" id="cmp-dist" placeholder="100" style="text-align:center; font-size:1.2em; margin-bottom:10px;">
        <button id="btn-calc-trip">–ò–∑—á–∏—Å–ª–∏</button>
    </div>
    <div id="compare-result"></div>
  </section>

  <section id="settings" class="tab">
    <div style="background:#111; padding:15px; border-radius:10px; border:1px solid #333; margin-bottom:20px;">
        <h3>üèéÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <div class="section-block"><label>EV –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç (mi/kWh)</label><input type="number" id="set_ev_eff" step="0.1"></div>
        <div class="section-block"><label>ICE –†–∞–∑—Ö–æ–¥ (MPG)</label><input type="number" id="set_ice_mpg" step="1"></div>
        <div class="section-block"><label>–¶–µ–Ω–∞ –ì–æ—Ä–∏–≤–æ (¬£/Liter)</label><input type="number" id="set_fuel_price" step="0.01"></div>
        <button id="saveCompareSettings">Save Settings</button>
    </div>
    <div style="background:#111; padding:15px; border-radius:10px; border:1px solid #333;">
        <h3>üíæ –î–∞–Ω–Ω–∏</h3>
        <button id="exportBackup" style="background:#333;">‚¨áÔ∏è Export JSON</button>
        <div style="margin-top:15px;"><label>Import JSON</label><input type="file" id="importBackup" /></div>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="main.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js').then(() => console.log('SW OK'));
      });
    }
  </script>

</body>
</html>
