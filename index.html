<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EV Log Cloud</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#4CAF50" />
</head>
<body>

  <div id="login-screen">
    <div class="login-box">
        <h1>EV Log Cloud ‚òÅÔ∏è</h1>
        <p>–í–ª–µ–∑, –∑–∞ –¥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–∞—à –¥–∞–Ω–Ω–∏—Ç–µ —Å–∏.</p>
        <button id="btnLogin">G –í—Ö–æ–¥ —Å Google</button>
    </div>
  </div>

  <div id="app-content" style="display:none;">
      <header>
        <div style="display:flex; justify-content:space-between; align-items:center; padding:0 10px;">
            <h1>EV Log</h1>
            <button id="btnLogout" class="small-btn">–ò–∑—Ö–æ–¥</button>
        </div>
        <h2>charging + maintenance</h2>
      </header>

      <nav>
        <button class="tabbtn active" data-tab="log">Log</button>
        <button class="tabbtn" data-tab="costs">Costs</button>
        <button class="tabbtn" data-tab="garage">Garage</button>
        <button class="tabbtn" data-tab="compare">Compare</button>
        <button class="tabbtn" data-tab="settings">Settings</button>
      </nav>

  <section id="log" class="tab active">
        
        <div id="home-stats" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:20px;">
            </div>

        <h3>–î–æ–±–∞–≤–∏ –ó–∞—Ä–µ–∂–¥–∞–Ω–µ</h3>
        
        <div style="display:flex; gap:10px;">
            <div class="input-group" style="flex:1;">
                <label>–î–∞—Ç–∞</label>
                <input type="date" id="date">
            </div>
            <div class="input-group" style="flex:1;">
                <label>–ö–∏–ª–æ–º–µ—Ç—Ä–∞–∂ (mi)</label>
                <input type="number" id="odo" placeholder="ex. 12500">
            </div>
        </div>

        <div class="input-group">
            <label>–¢–∏–ø</label>
            <select id="type">
                <option value="home" data-price="0.29">–î–æ–º–∞—à–Ω–æ (0.29)</option>
                <option value="public" data-price="0.56" selected>–ü—É–±–ª–∏—á–Ω–æ (0.56)</option>
                <option value="fast" data-price="0.79">–ë—ä—Ä–∑–æ (0.79)</option>
                <option value="work" data-price="0.00">–°–ª—É–∂–µ–±–Ω–æ (0.00)</option>
            </select>
        </div>

        <div class="input-group">
            <label>–ó–∞—Ä–µ–¥–µ–Ω–æ (kWh)</label>
            <input type="number" id="kwh" placeholder="ex. 45.5" step="0.1">
        </div>

        <div class="input-group">
            <label>–¶–µ–Ω–∞ (¬£/kWh)</label>
            <input type="number" id="price" step="0.01" placeholder="0.56">
        </div>

        <div id="log-preview" style="margin-bottom:15px; display:none;"></div>

        <div class="input-group">
            <label>–ë–µ–ª–µ–∂–∫–∞ (Optional)</label>
            <input type="text" id="note" placeholder="ex. Lidl charging">
        </div>

        <button id="addEntry">Add Entry</button>

        <h3>–ò—Å—Ç–æ—Ä–∏—è</h3>
        <div id="logTable">
            <p>Loading...</p>
        </div>
      </section>

      <section id="costs" class="tab">
        <div class="section-block">
          <label>–†–∞–∑—Ö–æ–¥ –∑–∞:</label>
          <select id="c_target" style="border:1px solid #555; background:#222;">
            <option value="ev">üöó –ú–æ—è—Ç–∞ –ö–æ–ª–∞ (EV)</option>
            <option value="ice">‚õΩ –î–í–ì (–í—Ç–æ—Ä–∞ –∫–æ–ª–∞)</option>
          </select>
        </div>
        <div class="section-block"><label>–î–∞—Ç–∞</label><input type="date" id="c_date" /></div>
        <div class="section-block">
          <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
          <select id="c_category">
            <option value="Tyres">–ì—É–º–∏</option>
            <option value="Service">–°–µ—Ä–≤–∏–∑</option>
            <option value="Insurance">–ó–∞—Å—Ç—Ä–∞—Ö–æ–≤–∫–∞</option>
            <option value="Tax">Road Tax</option>
            <option value="MOT">MOT (–ü—Ä–µ–≥–ª–µ–¥)</option>
            <option value="Other">–î—Ä—É–≥–æ</option>
          </select>
        </div>
        <div class="section-block"><label>–°—É–º–∞ (¬£)</label><input type="number" id="c_amount" placeholder="0.00" inputmode="decimal"/></div>
        <div class="section-block"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><input type="text" id="c_note" /></div>
        <button id="c_add">Add Cost</button>
        <div id="costTable" style="margin-top:20px;"></div>
      </section>

      <section id="garage" class="tab">
        <div class="garage-switcher">
            <button class="g-switch-btn active" id="btn-sw-ev">üöó EV Car</button>
            <button class="g-switch-btn" id="btn-sw-ice">‚õΩ ICE Car</button>
        </div>
        <div style="background:#1a1a1a; padding:15px; border-radius:10px; margin-bottom:20px; border:1px solid #333;">
            <h3 id="garage-title" style="margin-top:0; color:#ccc;">üîî –ù–∞–ø–æ–º–Ω—è–Ω–∏—è (EV)</h3>
            <div class="reminder-row"><label>Insurance</label><input type="date" id="g_insurance" class="garage-date"><div id="status_insurance" class="status-badge">--</div></div>
            <div class="reminder-row"><label>MOT (–ü—Ä–µ–≥–ª–µ–¥)</label><input type="date" id="g_mot" class="garage-date"><div id="status_mot" class="status-badge">--</div></div>
            <div class="reminder-row"><label>Road Tax (–î–∞–Ω—ä–∫)</label><input type="date" id="g_tax" class="garage-date"><div id="status_tax" class="status-badge">--</div></div>
            <div class="reminder-row"><label>Service (–û–±—Å–ª—É–∂–≤–∞–Ω–µ)</label><input type="date" id="g_service" class="garage-date"><div id="status_service" class="status-badge">--</div></div>
        </div>
        <div style="background:#1a1a1a; padding:15px; border-radius:10px; border:1px solid #333;">
            <h3 style="margin-top:0; color:#ccc;">üìÑ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–∞–Ω–Ω–∏</h3>
            <div class="section-block"><label>Reg. Plate</label><input type="text" id="g_plate" placeholder="XX00 XXX"></div>
            <div class="section-block"><label>VIN Number</label><input type="text" id="g_vin" placeholder="..." style="font-family:monospace;"></div>
            <div class="section-block"><label>Tyre Size (Front)</label><input type="text" id="g_tyre_f"></div>
            <div class="section-block"><label>Tyre Size (Rear)</label><input type="text" id="g_tyre_r"></div>
            <div class="section-block"><label>Notes</label><textarea id="g_notes" rows="3" style="width:100%; background:#222; color:#fff; border:1px solid #444; border-radius:8px; padding:10px;"></textarea></div>
            <button id="saveGarageManual" style="background:#333; margin-top:10px;">üíæ –ó–∞–ø–∞–∑–∏ –ø—Ä–æ–º–µ–Ω–∏—Ç–µ</button>
        </div>
      </section>

      <section id="compare" class="tab">
        <div id="tco-dashboard" style="display:none; margin-bottom:20px;">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div style="display:flex; justify-content:center; gap:10px; margin-bottom:15px;">
                <button id="btn-chart-cum" class="small-btn active" style="flex:1;">üìà –û–±—â–æ (Line)</button>
                <button id="btn-chart-month" class="small-btn" style="flex:1;">üìä –ú–µ—Å–µ—á–Ω–æ (Bar)</button>
            </div>
            <div id="tco-card" style="padding:15px; border-radius:10px; text-align:center; background:#222; margin-bottom:15px;"></div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:20px;">
                <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #4CAF50"><small style="color:#888">EV –¢–æ–∫</small><div id="stat-ev-charge" style="font-weight:bold">¬£0</div></div>
                <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #4CAF50"><small style="color:#888">EV –ü–æ–¥–¥—Ä—ä–∂–∫–∞</small><div id="stat-ev-maint" style="font-weight:bold">¬£0</div></div>
                <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #f44336"><small style="color:#888">ICE –ì–æ—Ä–∏–≤–æ</small><div id="stat-ice-fuel" style="font-weight:bold">¬£0</div></div>
                <div style="background:#1a1a1a; padding:10px; border-radius:5px; border-left:2px solid #f44336"><small style="color:#888">ICE –ü–æ–¥–¥—Ä—ä–∂–∫–∞</small><div id="stat-ice-maint" style="font-weight:bold">¬£0</div></div>
            </div>
            <div style="text-align:center; margin-bottom:10px;">–ü—Ä–æ–±–µ–≥: <span id="stat-miles">0</span> mi</div>
            <div style="background:#1a1a1a; padding:10px; border-radius:10px; height:300px;"><canvas id="tcoChart"></canvas></div>
        </div>
        <h3>üßÆ –ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä (Trip)</h3>
        <div class="compare-box" style="background:#111; padding:15px; border-radius:10px; text-align:center;">
            <label>–†–∞–∑—Å—Ç–æ—è–Ω–∏–µ (–º–∏–ª–∏)</label>
            <input type="number" id="cmp-dist" placeholder="100" style="text-align:center; font-size:1.2em; margin-bottom:10px;">
            <button id="btn-calc-trip">–ò–∑—á–∏—Å–ª–∏</button>
        </div>
        <div id="compare-result"></div>
      </section>

      <section id="settings" class="tab">
        <div style="background:#111; padding:15px; border-radius:10px; border:1px solid #333; margin-bottom:20px;">
            <h3>üèéÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
            <div class="section-block"><label>EV –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç (mi/kWh)</label><input type="number" id="set_ev_eff" step="0.1"></div>
            <div class="section-block"><label>ICE –†–∞–∑—Ö–æ–¥ (MPG)</label><input type="number" id="set_ice_mpg" step="1"></div>
            <div class="section-block"><label>–¶–µ–Ω–∞ –ì–æ—Ä–∏–≤–æ (¬£/Liter)</label><input type="number" id="set_fuel_price" step="0.01"></div>
            <button id="saveCompareSettings">Save Settings</button>
        </div>

        <div style="background:#111; padding:15px; border-radius:10px; border:1px solid #333; margin-bottom:20px;">
            <h3>üíæ –î–∞–Ω–Ω–∏ (Export)</h3>
            <p style="font-size:0.8rem; color:#888; margin-top:0;">–°–≤–∞–ª–∏ –≤—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏ –≤ Excel (CSV) —Ñ–æ—Ä–º–∞—Ç.</p>
            <div style="display:flex; gap:10px;">
                <button id="btnExportLogs" style="background:#333; margin-top:10px;">üìÑ Logs.csv</button>
                <button id="btnExportCosts" style="background:#333; margin-top:10px;">üí∞ Costs.csv</button>
            </div>
        </div>
        
        <div style="background:#111; padding:15px; border-radius:10px; border:1px solid #333; margin-bottom:20px; border-left: 4px solid #ff9800;">
            <h3>üì• –ò–º–ø–æ—Ä—Ç (Restore)</h3>
            <p style="font-size:0.8rem; color:#888; margin-top:0;">–í—ä–∑—Å—Ç–∞–Ω–æ–≤–∏ –¥–∞–Ω–Ω–∏ –æ—Ç CSV —Ñ–∞–π–ª. –í–Ω–∏–º–∞–Ω–∏–µ: –∑–∞–ø–∏—Å–∏—Ç–µ —â–µ —Å–µ –¥–æ–±–∞–≤—è—Ç –∫—ä–º —Ç–µ–∫—É—â–∏—Ç–µ.</p>
            <input type="file" id="importFile" accept=".csv" style="margin-top:10px; font-size:0.9em;">
            <button id="btnImport" style="background:#ff9800; color:#000; margin-top:10px;">–°—Ç–∞—Ä—Ç –ò–º–ø–æ—Ä—Ç</button>
        </div>

        <div style="text-align:center; color:#666; font-size:0.8rem;">Logged in as: <span id="user-email"></span></div>
      </section>
  </div>

  <script type="module" src="main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
  </script>
</body>
</html>
